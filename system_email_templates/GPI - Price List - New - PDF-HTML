<?xml version="1.0"?>
<!DOCTYPE pdf PUBLIC "-//big.faceless.org//report" "report-1.1.dtd">
<pdf>
<head>
	<link name="NotoSans" type="font" subtype="truetype" src="${nsfont.NotoSans_Regular}" src-bold="${nsfont.NotoSans_Bold}" src-italic="${nsfont.NotoSans_Italic}" src-bolditalic="${nsfont.NotoSans_BoldItalic}" bytes="2" />
	<#if .locale == "zh_CN">
		<link name="NotoSansCJKsc" type="font" subtype="opentype" src="${nsfont.NotoSansCJKsc_Regular}" src-bold="${nsfont.NotoSansCJKsc_Bold}" bytes="2" />
	<#elseif .locale == "zh_TW">
		<link name="NotoSansCJKtc" type="font" subtype="opentype" src="${nsfont.NotoSansCJKtc_Regular}" src-bold="${nsfont.NotoSansCJKtc_Bold}" bytes="2" />
	<#elseif .locale == "ja_JP">
		<link name="NotoSansCJKjp" type="font" subtype="opentype" src="${nsfont.NotoSansCJKjp_Regular}" src-bold="${nsfont.NotoSansCJKjp_Bold}" bytes="2" />
	<#elseif .locale == "ko_KR">
		<link name="NotoSansCJKkr" type="font" subtype="opentype" src="${nsfont.NotoSansCJKkr_Regular}" src-bold="${nsfont.NotoSansCJKkr_Bold}" bytes="2" />
	<#elseif .locale == "th_TH">
		<link name="NotoSansThai" type="font" subtype="opentype" src="${nsfont.NotoSansThai_Regular}" src-bold="${nsfont.NotoSansThai_Bold}" bytes="2" />
	</#if>

    <macrolist>
        <macro id="nlheader">
            <table class="header" style="width: 100%;">
                <tr>
                    <td rowspan="5" style="width:37%;"><#if companyInformation.logoUrl?length != 0><@filecabinet nstype="image" src="${companyInformation.logoUrl}" style="float: left; margin: 7px;width:250px;height:70px;" /> </#if></td>
	                <td rowspan="5" style="width:23%;border-left: 3px solid #c4c3c0;vertical-align: middle;padding-left:5px;">orders@royalbag.com<br />718-686-1120<br />www.royalbag.com</td>
                    <td align="right"><span class="title">${record@title}</span></td>
                </tr>
                <tr></tr>
            </table>
        </macro>

        <macro id="nlfooter">
            <table class="footer" style="width: 100%;">
                <tr>
                    <td align="left">${record.trandate} - ${customer.pricelevel}</td>
                    <td align="right"><pagenumber/> of <totalpages/></td>
                </tr>
            </table>
        </macro>
    </macrolist>

    <style type="text/css">
		* {
		<#if .locale == "zh_CN">
			font-family: NotoSans, NotoSansCJKsc, sans-serif;
		<#elseif .locale == "zh_TW">
			font-family: NotoSans, NotoSansCJKtc, sans-serif;
		<#elseif .locale == "ja_JP">
			font-family: NotoSans, NotoSansCJKjp, sans-serif;
		<#elseif .locale == "ko_KR">
			font-family: NotoSans, NotoSansCJKkr, sans-serif;
		<#elseif .locale == "th_TH">
			font-family: NotoSans, NotoSansThai, sans-serif;
		<#else>
			font-family: NotoSans, sans-serif;
		</#if>
		}
		table {
			font-size: 9pt;
			table-layout: fixed;
		}
        th {
            font-weight: bold;
            font-size: 8pt;
            vertical-align: middle;
            padding: 5px 6px 3px;
            background-color: #e3e3e3;
            color: #333333;
        }
        td {
            padding: 4px 6px;
        }
		td p { align:left }
        b {
            font-weight: bold;
            color: #333333;
        }
        table.header td {
            padding: 0;
            font-size: 10pt;
        }
        table.footer td {
            padding: 0;
            font-size: 8pt;
        }
        table.itemtable {
          border: 1px solid black;
        }
        table.itemtable th {
            padding-bottom: 10px;
            padding-top: 10px;
        }
        table.body td {
            padding-top: 2px;
        }
        td.addressheader {
            font-weight: bold;
            font-size: 8pt;
            padding-top: 6px;
            padding-bottom: 2px;
        }
        td.address {
            padding-top: 0px;
        }
        span.title {
            font-size: 28pt;
        }
        span.itemname {
            font-weight: bold;
            line-height: 150%;
        }
        hr {
            width: 100%;
            color: #d3d3d3;
            background-color: #d3d3d3;
            height: 1px;
        }
    </style>
</head>

<body header="nlheader" header-height="10%" footer="nlfooter" footer-height="20pt" padding="0.3in 0.3in 0.1in 0.3in" size="Letter">

  <#-- =========================
       GROUP LINES BY CATEGORY
       ========================= -->
  <#assign catMap = {}>

  <#list record.pricelevels as lines>
    <#list lines as line>
      <#assign cat = (line.custitem_rb_pl_category!"Uncategorized")?string?trim>
      <#assign catMap = catMap + { (cat) : ( (catMap[cat])![] ) + [line] } >
    </#list>
  </#list>

  <#-- =========================
       PREFERRED CATEGORY ORDER
       (controls Categories list + grouped item order)
       ========================= -->

  <#assign preferredOrder = [
    "Clear 4mil Reclosable Bags",
    "Clear 2mil Reclosable Bags",
    "2mil Slider Bags",
    "Clear 8mil Reclosable Bags",
    "Clear 3mil Reclosable Bags",
    "Clear 6mil Reclosable Bags",
    "2mil Write-on White Block Reclosable Bags",
    "4mil Write-on White Block Reclosable Bags",
    "4mil Write-on Parts and Qty Reclosable Bags",
    "2mil Hang Hole Reclosable Bags",
    "4mil Hang Hole Reclosable Bags",
    "2mil Crystal Clear (Polypropylene) Hang Hole Reclosable Bags",
    "4mil Reinforced Grommet Reclosable Bags",
    "2mil Vent Hole Reclosable Bags",
    "2mil White Block Slider Bags",
    "3mil Slider Bags",
    "4mil Slider Bags",
    "Drawstring Bags",
    "Bubble Reclosable Bags",
    "Recycle Logo Reclosable Bags",
    "Suffocation Warning + Recycle Logo Reclosable Bags",
    "Compostable Reclosable Bags",
    "Split Compartment Reclosable Bags",
    "Pouch Reclosable Bags",
    "2mil Tamper Evident Reclosable Bags",
    "3mil Tamper Evident Reclosable Bags",
    "4mil Tamper Evident Reclosable Bags",
    "Wicketed Tamper Evident Reclosable Bags",
    "Die Cut Handle Reclosable Bags",
    "Biodegradable Die Cut Handle Reclosable Bags",
    "Colored Reclosable Bags",
    "Tiny Colored Bags",
    "Tiny Design Bags",
    "UV Protective Amber Reclosable Bags",
    "PRN Reclosable Bags",
    "Refrigerate Reclosable Bags",
    "Biohazard Specimen Reclosable Bags",
    "Chemotherapy Drug Transport Reclosable Bags",
    "Red Biohazard Waste Bags",
    "Asbestos Hazard Bags",
    "Pink Antistat Reclosable Bags",
    "Metallic Static Shielding Reclosable Bags",
    "Cigar Reclosable Bags",
    "Resealable Lip & Tape with Suffocation Warning",
    "Resealable Lip & Tape with Suffocation Warning and Vent Holes",
    "Permanent Lip & Tape with Suffocation Warning",
    "Bubble Lip & Tape",
    "1.5mil Polypropylene Lip & Tape",
    "1.6mil Polypropylene Lip & Tape",
    "Poly Mailers",
    "Economic Poly Mailers",
    "Expansion Poly Mailers",
    "Bubble Mailers",
    "Perforated Poly Mailers",
    "Returnable Poly Mailers",
    "50% PCR Perforated Poly Mailers",
    "100% PCR Poly Mailers",
    "Clear Mailers",
    "1mil Flat Poly Bags",
    "1.25mil Flat Poly Bags",
    "1.5mil Flat Poly Bags",
    "2mil Flat Poly Bags",
    "3mil Flat Poly Bags",
    "4mil Flat Poly Bags",
    "6mil Flat Poly Bags",
    "8mil Flat Poly Bags",
    "1.5mil Crystal Clear (Polypropylene) Poly Bags",
    "1mil Suffocation Warning Poly Bags",
    "2mil Suffocation Warning Poly Bags",
    "2mil Pink Antistat Poly Bags",
    "4mil Pink Antistat Poly Bags",
    "1mil Gusseted Poly Bags (case)",
    "1.25mil Gusseted Poly Bags (case)",
    "1.5mil Gusseted Poly Bags (case)",
    "2mil Gusseted Poly Bags (case)",
    "3mil Gusseted Poly Bags (case)",
    "1.5mil Crystal Clear (Polypropylene) Side Gusseted Bags",
    "1.5mil Crystal Clear (Polypropylene) Bottom Gusseted Bags",
    "1mil Gusseted Poly Bags (roll)",
    "1.5mil Gusseted Poly Bags (roll)",
    "2mil Gusseted Poly Bags (roll)",
    "3mil Gusseted Poly Bags (roll)",
    "4mil Gusseted Poly Bags (roll)",
    "1.5mil Clear Pre-opened Bags (Automated Packaging)",
    "2mil Clear Pre-opened Bags (Automated Packaging)",
    "2mil White Front, Clear Back Pre-opened Bags (Automated Packaging)",
    "Pallet Sheeting",
    "1.5mil Poly Tubing Rolls",
    "2mil Poly Tubing Rolls",
    "3mil Poly Tubing Rolls",
    "4mil Poly Tubing Rolls",
    "6mil Poly Tubing Rolls",
    "Tubing Dispensers",
    "1.5mil Standard Mattress Bags",
    "3mil Standard Mattress Bags",
    "4mil Standard Mattress Bags",
    "3mil Pillow Top Mattress Bags",
    "4mil Pillow Top Mattress Bags",
    "Clear Stand Up Pouches",
    "Clear Front/Silver Back Stand Up Pouches",
    "Bottom-Loading Barrier Zipper Pouches",
    "Sandwich Bags",
    "Vacuum Seal Bags",
    "Bread Bags with Wickets",
    "Deli Bags",
    "Ice Bags",
    "Silverware Bags",
    "Clear Low-Density Merchandise Bags",
    "White Low-Density Merchandise Bags",
    "Frosted Low-Density Merchandise Bags",
    "Magazine & Brochure Doorknob Hanging Bags",
    "Garment Bags",
    "Garbage Bags",
    "Soiled Linen Laundry Bags",
    "Clear Packing List Envelopes",
    "Packing List Envelopes, Printed 'Packing List Enclosed'",
    "Adhesive Press-on Reclosable Bags",
    "Hang Tabs",
    "Bag Sealing Tape Rolls",
    "Packing Tape",
    "Reinforced Brown Packing Tape, Water Activated",
    "Twist Ties",
    "Nylon Cable Ties",
    "Closeout"
  ]>

  <#-- Build catNames in preferred order, but only if they exist in this run -->
  <#assign catNames = []>
  <#list preferredOrder as catName>
    <#if catMap[catName]??>
      <#assign catNames = catNames + [catName]>
    </#if>
  </#list>

  <#-- Append any new/unlisted categories at the end (alphabetical for neatness) -->
  <#assign allCatsSorted = catMap?keys?sort>
  <#list allCatsSorted as k>
    <#if !catNames?seq_contains(k)>
      <#assign catNames = catNames + [k]>
    </#if>
  </#list>

  <span style="font-size: 18px"><b>Categories:</b></span>

  <table style="width: 100%;">
    <#list catNames as catName>
      <tr>
        <td style="border-bottom: .2px solid gray;font-size: 14px">${catName}</td>
      </tr>
    </#list>
  </table>

  <span style="font-size: 12px"><br /><b>Reminder:</b> Prices listed in this document are confidential, and shall not be disclosed to any third parties
without RoyalBag's prior written consent.</span>

  <pbr />

  <table class="itemtable" style="width: 100%;">
    <thead>
      <tr>
        <th align="center" colspan="4" style="border: .5px solid black;">Item ID</th>
        <th align="center" colspan="6" style="border: .5px solid black;">Size</th>
        <th align="center" colspan="3" style="border: .5px solid black;">UOM</th>
        <th align="center" colspan="2" style="border: .5px solid black;">Price</th>
        <th align="center" colspan="2" style="border: .5px solid black;">Per MC</th>
        <th align="center" colspan="2" style="border: .5px solid black;">MC Weight</th>
      </tr>
    </thead>

    <tbody>
      <#list catNames as catName>

        <tr>
          <td colspan="19" style="border: .5px solid black;"><b>${catName}</b></td>
        </tr>

        <#-- Sort items inside each category by custitem_rb_item -->
        <#list (catMap[catName])?sort_by(["custitem_rb_item"]) as line>
          <tr>
            <td colspan="4" style="border: .5px solid gray;">${line.custitem_rb_item}</td>
            <td align="left" colspan="6" style="border: .5px solid gray;">${line.custitem_rb_size}</td>
            <td align="left" colspan="3" style="border: .5px solid gray;">${line.units}</td>
            <td align="right" colspan="2" style="border: .5px solid gray;">${line.rate}</td>
            <td align="right" colspan="2" style="border: .5px solid gray;">${line.custitem_rb_per_mc}</td>
            <td align="right" colspan="2" style="border: .5px solid gray;">${line.custitem_rb_mc_weight}</td>
          </tr>
        </#list>

      </#list>
    </tbody>
  </table>

</body>
</pdf>