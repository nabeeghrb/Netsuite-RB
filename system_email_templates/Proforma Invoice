<?xml version="1.0"?>
<!DOCTYPE pdf PUBLIC "-//big.faceless.org//report" "report-1.1.dtd">
<pdf>
<head>
<link name="Helvetica" type="font" subtype="type1"
src="${nsfont.Helvetica}"
src-bold="${nsfont.Helvetica_Bold}"
src-italic="${nsfont.Helvetica_Oblique}"
src-bolditalic="${nsfont.Helvetica_BoldOblique}"
bytes="2" />
<style>
body {
font-family: Helvetica;
color: #000;
width: 880px;
overflow: scroll;
margin: 0 auto;
}

p {
margin: 5 0;
}

.indent {
padding-left: 20px;
}
</style>
</head>
<body header="nlheader" header-height="10%" footer="nlfooter" footer-height="20pt"
padding="0.5in 0.5in 0.5in 0.5in" size="Letter">

<table class="header" style="width: 100%; font-size: 10pt;">
<tr>
<td align="center">
<a href="https://www.royalbag.com/">
<img
src="https://888714.app.netsuite.com/core/media/media.nl?id=85432&c=888714&h=vx45izYbE3z0ZLBovy-0uBxWOUM9oiZisXN0sQGbeqEUODZw" />
</a>
</td>
<td style="width: 20%; border-left: 3px solid #c4c3c0; vertical-align: middle; padding-left: 5px; font-size: 10pt;">
                    cs@royalbag.com<br />
                    866-686-7401<br />
                    www.royalbag.com
                </td>
                <td style="width: 40%; text-align: right; vertical-align: top; padding: 0;">
                    <span style="font-size: 28pt; color: #333333;">Proforma Invoice</span><br />
                    <span style="font-size: 16pt; color: #333333;">#${transaction.tranid}</span>
                </td>
</tr>
</table>

<table style="width: 100%; margin-top: 48px; padding-bottom: 12; border-bottom: 0.3px solid;">
<tr>
<td style="vertical-align: middle; width: auto; padding-left: 0; color:#3c763d">
<p style="font-size: 16pt; font-weight: 500;">Thank you for choosing RoyalBag.</p>
</td>
<td style="width: auto; text-align: right;">
<p style="">Date: ${transaction.trandate}</p>
<#if transaction.otherrefnum?has_content>
<p style="">PO #${transaction.otherrefnum}</p>
</#if>
</td>
</tr>
</table>

<table style="width: 100%; margin-top: 48px;">
<tr>
<td style="vertical-align: top;">
<strong>Bill To:</strong>
<p class="indent">${transaction.billaddress}</p>
</td>
<td style="vertical-align: top;">
<strong>Ship To:</strong>
<p class="indent">${transaction.shipaddress}</p>
</td>
<td style="vertical-align: top;">
<strong>Ship method:</strong>
<p class="indent">${transaction.shipmethod}</p>
</td>
</tr>
</table>

<#if transaction.item?has_content>
<table
style="width: 100%; margin-top: 16px; border-collapse: separate; border-spacing: 0; border: 1px solid black;">
<thead>
<tr>
<th style="padding: 8px; border-bottom: 1px solid black; text-align: left;">Item</th>
<th style="padding: 8px; border-bottom: 1px solid black; text-align: center;">Unit</th>
<th style="padding: 8px; border-bottom: 1px solid black; text-align: center;">Over/Underrun</th>
<th style="padding: 8px; border-bottom: 1px solid black; text-align: right;">Price</th>
<th style="padding: 8px; border-bottom: 1px solid black; text-align: center;">Qty</th>
<th style="padding: 8px; border-bottom: 1px solid black; text-align: right;">Total</th>
</tr>
</thead>
<#list transaction.item as item>
<tr>
<td style="padding: 8px; text-align: left;">
<span>${item.item}</span>
<#if item.custcol_scm_customerpartnumber?has_content>
<span><br />P/N: ${item.custcol_scm_customerpartnumber}</span>
</#if>
</td>
<td style="padding: 8px; border-left: 1px dashed black; text-align: center;">
<span>${item.units}</span>
</td>
<td style="padding: 8px; border-left: 1px dashed black; text-align: center;">
<#if item.custcol_rb_overunderpercentage?has_content>
<span>${item.custcol_rb_overunderpercentage}</span>
<#else>
<span>-</span>
</#if>
</td>
<td style="padding: 8px; border-left: 1px dashed black; text-align: right;">
<span>${item.rate}</span>
</td>
<td style="padding: 8px; border-left: 1px dashed black; text-align: center;">
<span>${item.quantity}</span>
</td>
<td style="padding: 8px; border-left: 1px dashed black; text-align: right;">
<span>${item.amount}</span>
</td>
</tr>
</#list>
</table>
</#if>

<!-- Lead Time -->
<#if transaction.custbody_rb_custom_production == true >
<table style="width: 100%; margin-top: 16px;">
<tr>
<td style="width: 50%; vertical-align: top;">

<span style="font-weight: bold;">Lead Time:</span> <#if transaction.custbody_lead_time?has_content>${transaction.custbody_lead_time}<#else>TBD<br></#if>
<span style="font-weight: bold;">Tolerances:</span> Due to industry tolerances, custom bags are subject to +/- 1/4" on size and 10% on thickness.
</td>
</tr>
</table>
</#if>

<table style="page-break-inside: avoid; width: 100%; margin-top: 16px;">
<tr>
<td colspan="4"></td>
<td align="right" style="font-weight: bold; color: #333333;">${transaction.subtotal@label}:</td>
<td align="right">${transaction.subtotal}</td>
</tr>
<tr>
<td colspan="4"></td>
<td align="right" style="font-weight: bold; color: #333333;">
Discount:</td>
<td align="right">-${transaction.discounttotal?replace("[()]","","r")}</td>
</tr>
<tr>
<td colspan="4"></td>
<td align="right" style="font-weight: bold; color: #333333;">Tax:</td>
<td align="right">${transaction.taxtotal}</td>
</tr>
<tr>
<td colspan="4"></td>
<td align="right" style="font-weight: bold; color: #333333;">Shipping:</td>
<td align="right">
<#if transaction.shipmethod?has_content && transaction.shipmethod?trim?upper_case == "TBD">
  TBD
<#elseif transaction.shipmethod?has_content && transaction.shipmethod?trim?upper_case != "TBD" && transaction.shippingcost?has_content>
  ${transaction.shippingcost}
<#else>
  TBD
</#if>
</td>
</tr>
<tr style="line-height: 200%;">
<td background-color="#ffffff" colspan="4"></td>
<td align="right" style="font-weight: bold; color: #333333;">${transaction.total@label}:</td>
<td align="right">${transaction.total}</td>
</tr>
</table>

<table style="width:100%;margin-top:15px;"><tr><td align="left" style="font-size:12px;">
<b>Remittance information:</b><br/>
Mail - Royal Bag Inc. 5501 New Utrecht Ave. Suite 501 Brooklyn NY 11219<br/>
EFT - Routing: 021000021 Account 166176630. Please include Invoice# in payment reference and email remittance advice to billing@royalbag.com.
</td></tr></table>

<hr>
  
<table style="width: 100%; margin-top: 16px;">
  <#-- Variables for calculated deposits -->
  <#assign depTotal = 0.0>
  <#assign hasDeposits = false>

  <#-- First pass: collect deposits and calculate total -->
  <#list transaction.links?if_exists as link>
    <#-- Only include Customer Deposit records -->
    <#if link.type?has_content && link.type == "Customer Deposit">

      <#-- Mark that we have at least one deposit -->
      <#assign hasDeposits = true>

      <#-- Convert formatted total (e.g. "$1,234.56") into a number -->
      <#assign depAmount =
          link.total?string
                     ?replace("$", "")
                     ?replace(",", "")
                     ?number
      >
      <#assign depTotal = depTotal + depAmount>
    </#if>
  </#list>

  <#-- Second pass: render details if any deposits exist -->
  <#if hasDeposits>
    <tr>
      <td style="padding-top:8px;">
        <strong>Payments:</strong>
        <table style="width:100%; margin-top:4px">
          <thead>
            <tr>
              <th align="left">Date</th>
              <th align="left">Deposit #</th>
              <th align="right">Amount</th>
            </tr>
          </thead>
          <tbody>
            <#list transaction.links?if_exists as link>
              <#if link.type?has_content && link.type == "Customer Deposit">
                <tr>
                  <td>${link.trandate}</td>
                  <td>${link.tranid}</td>
                  <td align="right">${link.total}</td>
                </tr>
              </#if>
            </#list>

            <tr>
              <td colspan="2" align="right"><strong>Total Deposits:</strong></td>
              <td align="right">
                <strong>${depTotal?string["$#,##0.00"]}</strong>
              </td>
            </tr>
          </tbody>
        </table>
      </td>
    </tr>
  <#else>
    <tr>
      <td>No customer deposits found for this order.</td>
    </tr>
  </#if>
</table>

</body>
</pdf>